\startEXERCISE
有向圖 $G=(V,E)$ 的\emph{平方圖}是圖 $G^2=(V,E^2)$，
$(u,v)\in E^2$ 當且僅當圖 $G$ 包含一條最多由兩條邊構成的從 $u$ 到 $v$ 的路徑。
請給出一個有效算法來計算圖 $G$ 的平方圖 $G^2$。
這裏圖 $G$ 既可以以鄰接表表示，
也可以以鄰接矩陣表示。
請分析算法的運行時間。
\stopEXERCISE

\startANSWER
鄰接矩陣： $M^2[u,w] = \sum_{v}M[u,v]\cdot M[v,w]$，即矩陣相乘；
時間複雜度爲 \m{O(V^3)}。
如果採用 Strassen 算法則爲 $O(V^{\lg 7})$。

若採用鄰接鏈表：
遍歷所有邊 $(u,v)$，然後再遍歷 $v$ 的所有鄰接頂點 $w$，
將 $w$ 加入到新的鄰接表中（利用額外數列記錄是否已經添加過，以解決衝突）。時間複雜度爲 $O(VE)$。
\stopANSWER
